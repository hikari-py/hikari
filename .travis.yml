language: ruby

if: branch = task/ci/docker-containers

env:
  global:
    - DOCKER_DRIVER="overlay2"
    - secure: "iT8BrzRDN7WMs2t8Iv2/6zKHf1sNbWngafQ5kNLumxwpK46h6EVEmBLj/GWZdlr0FZcWnf72QlXJZav+BtEAqmUeelZLYmp9RJKo8rXVKtpKBCcLVdVCDROMhnUb+7EHLO2LLub/0duIfdsoJWGZt/GwclJZ7106NH8RbTB+MdddAXkmbvQFN49FqBRfyqvJQZ25Tz23W+8r4m0joHkQx5+ojLuYlMsOHTpPz8esOAIbJh+zl0nY3zglLfbwCZHLXrbhg5Suq70Up9QCwes2Tp2lme2pOH96ynT+JDgGPRkV5yYuutyGqSNoGcCnsykDwoUXuQS/Ff+bzFbELgBkrYPnLn7y8NgBhydnUT7wD0TRuLPOh2ivyqhOCnfE9QN2en4uPBYAO8qA1+kxfeOZePstm/I/7dzGXmIn5Lv5AlJXWt8ubgu5H0FJin9FQWNTbmUywF7oCWSJIVSdddNj4xQG84t3d9xN7API+NWR3p6MTUaxNWQHHOsj9OuIQDgLszJi74jX+mSyeHYi2O7wS6x4whi83RxFgKyicMQCke4+OMBWIQykUekim5QLwe0KcvBPbTzJAzsOo+UkOm9s5GglARlhFDTRlfgJCbPDNea7FhcZqSlwf91GM5IVXa96UiZ/zMVzzb5Naldgn9NA61vM+T2V24cWZbCaIwozOpg="
    - secure: "cuk2Dy8SqdN/CpOAQqS1JPVbTGz8GRvU7xk/pPFJ9fQDgt7YS6LOTDAvywuGihS5pPFcf85oLscihW2sl90ewgr57QJcj+eXTYbpQORTDtV1c4dxTOYzJGkF8ZyXXCbZcmI6fNm2ejtKf1qD/tys0wIhlPFXN8aH1SpWCecXY4lA6ormH/Y3MdoaYy+rhHqo2Z011eOVwaCmy1F6Ur9yQUuWMGtXs77MV4VeBXGWl5eF4lninlGU0bnutL0XIJ6DUPn+V1uiMGL9pb5rc2T1/GjIsHC3/gmNj9fa3t6t3E6A7XpFyfO9jp5J4NGdb4gjPyXul9sMWputKLB+yP+F5EWpj90FseCa1DWl9yLf4I+DHkEHOuJHJTr++ATEShEds8z7r/x6giBIKXk46U3jcs/IEA0mPo6K+cYS4h+B3sXURs2HNTVOJYyGCxkr/CVVpuCSkTV3WOyzYtaLzXl0aGC3R83miHSb51CQITvQZq7SXseR0dMnflXIgBZTbWeKeoTlXq3qIOBEULI7z9lmZbvboN2LA4CwGNk1D/0dD9a+KipP3PMSRyp6bGBRsu1VxyF6YkdNl7Lx1edHH4UTbvgmrZv5qN6tDUMO9e9woPDp5EprH8RBx9EIE5lbxkkrP4zzzx1a7TDli0wg4jD7K86QOyOb99bLz6g2WFFIX0M="
  jobs:
    - DOCKERFILE=docker/stackless/3.8.0b3.dockerfile
      IMAGE=stackless-python-hikari:3.8.0b3

before_script: docker login -u "${DOCKER_USER}" -p "${DOCKER_ACCESS_TOKEN}"
script: docker build -t "${DOCKER_USER}/${IMAGE}" --file "${DOCKERFILE}" .
after_script: docker push "${DOCKER_USER}/${IMAGE}"
